const util = require('util')
const streamPipeline = util.promisify(require('stream').pipeline)
const fetch = require('node-fetch')
const fs = require('fs')
const Discord = require('discord.js')
const config = require('../config.json')

module.exports = {
  name: 'ogloszenia',
  description: 'GET SchoolNotices',
  aliases: ['kotbingo', 'rozpierdolkota'],
  async execute (interaction) {
    const res = await fetch(
      'https://api.librus.pl/2.0/SchoolNotices',
      {
        headers: {
          Host: 'api.librus.pl',
          Connection: 'keep-alive',
          Accept: 'application/json',
          DNT: '1',
          Authorization: config.librusAuthorization,
          'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36',
          Origin: 'https://portal.librus.pl',
          'Sec-Fetch-Site': 'same-site',
          'Sec-Fetch-Mode': 'cors',
          'Sec-Fetch-Dest': 'empty',
          Referer: 'https://portal.librus.pl/',
          'Accept-Encoding': 'gzip, deflate, br',
          'Accept-Language': 'en-GB,en;q=0.9'
        }
      }
    )
    const restext = await res.text()
    console.log(restext)
    console.log(JSON.parse(restext))
  }
}
